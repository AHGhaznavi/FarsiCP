#برش درخت (نسخه سخت)

به شما یک درخت غیر جهت دار شامل $n$ راس داده میشود.

بعضی از رئوس آن به یکی از $k$ رنگ، رنگ شده اند و برخی از آنها رنگ نشده اند. تضمین میشود که درخت شامل حداقل یک راس از هر یک از رنگ ها میباشد. ولی ممکن است راس بدون رنگ وجود نداشته باشد.

شما باید **دقیقا $k-1$ یال** انتخاب کنید و آنها را از گراف حذف کنید. در نتیجه درخت به $k$ مولفه تقسیم میشود. به این زیر مجموعه از یالها *خوب* میگوییم اگر هیچکدام از این مولفه ها شامل دو راس با رنگ های متفاوت نباشند.

چه تعداد زیرمجموعه ی *خوب* از یالها درون درخت یافت میشود؟ دو زیر مجموعه متفاوت در نظر گرفته میشوند اگر یالی درون یکی از آنها باشد که درون دیگری نیست.

از آنجا که جواب ممکن است بزرگ باشد باقیمانده ی آن را بر $998244353$ چاپ کنید.

#ورودی

خط اول شامل دو عدد $n$ و $k$ است $(2 \le n \le 3 \cdot 10^5 , 2 \le k \le n)$ —  که به ترتیب تعداد رئوس درخت و تعداد رنگ ها هستند.

خط دوم شامل  $n$ عدد $a_1, a_2, \dots, a_n$ $(0 \le a_i \le k)$ — که درواقع رنگ رئوس هستند. اگر $a_i = 0$ به معنی این است که راس $i$ رنگ نشده است، و در غیر این صورت رنگ راس $i$ را نشان میدهد.

در $i$امین خط از $n-1$ خط بعدی ورودی دو عدد $u_i$ و $v_i$ $(1 \le v_i, u_i \le n , v_i \ne u_i)$ داده میشود — که درواقع یال های درخت هستند. تضمین میشود که یال هایی که به عنوان ورودی داده میشود تشکیل یک درخت میدهد. همچنین تضمین میشود که به ازای هر رنگ حداقل یک راس ا رنگ مورد نظر در درخت ورودی وجود دارد. ولی ممکن است راس بدون رنگ وجود نداشته باشد.

#خروجی

یک عدد چاپ کنید —که باید برابر با تعداد زیر مجموعه های *خوب* در درخت داده شده باشد. دو زیر مجموعه متفاوت در نظر گرفته میشوند اگر یالی درون یکی از آنها باشد که درون دیگری نیست.

از آنجا که جواب ممکن است بزرگ باشد باقیمانده ی آن را بر $998244353$ چاپ کنید.

#نمونه ها

نمونه1:

ورودی

    5 2
    2 0 0 1 2
    1 2
    2 3
    2 4
    2 5

خروجی

    1

نمونه2:

ورودی

    7 3
    0 1 0 2 2 3 0
    1 3
    1 4
    1 5
    2 7
    3 6
    4 7

خروجی

    4

#توضیحات

شکل زیر درخت نمونه1 را نشان میدهد:

![image description](http://uupload.ir/files/mqy4_42ca10f5af2aab9d8e427b9267615b48add8baa5.png)

تنها زیر مجموعه ی *خوب* این درخت $(2, 4)$ است. حذف کردن این یال باعث میشود درخت به دو مولفه ی $\{4\}$  و  $\{1, 2, 3, 5\}$  تقسیم شود. مولفه ی اول تنها شامل یک راس با رنگ $1$ است و مولفه ی دوم شامل رئوس با رنگ ها $2$ و رئوس بی رنگ است.

شکل زیر درخت نمونه2 است:

![image description](http://uupload.ir/files/5uo5_c1c2274c20e881c79146b82d05264e348fc7db4a.png)

زیر مجموعه های *خوب* در این شکل $\{(1, 3), (4, 7)\}$ و $\{(1, 3), (7, 2)\}$ و $\{(3, 6), (4, 7)\}$ و $\{(3, 6), (7, 2)\}$ هستند.
